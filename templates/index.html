<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>阿泽码字助手</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- 顶部工具栏 -->
    <div class="toolbar">
        <div class="toolbar-left">
            <h1>阿泽码字助手</h1>
        </div>
        <div class="toolbar-center">
            <div class="document-info">
                <span id="current-doc-name">未命名文档</span>
                <span class="save-status" id="save-status">已保存</span>
            </div>
        </div>
        <div class="toolbar-right">
            <button class="btn btn-secondary" id="settings-btn" title="设置">
                <i class="fas fa-cog"></i>
            </button>
            <select id="language-select" class="language-select">
                <option value="zh-CN">中文</option>
                <option value="en">English</option>
            </select>
        </div>
    </div>

    <!-- 主容器 -->
    <div class="main-container">
        <!-- 左侧边栏 -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3 data-i18n="documents">文档</h3>
                <button class="btn btn-primary" id="new-doc-btn" title="新建文档">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
            <div class="document-list" id="document-list">
                <!-- 文档列表将在这里动态生成 -->
            </div>
        </div>

        <!-- 编辑区域 -->
        <div class="editor-container">
            <div class="editor-wrapper">
                <textarea id="editor" placeholder="开始写作..." data-i18n-placeholder="start_writing"></textarea>
            </div>
        </div>

        <!-- 右侧AI助手 -->
        <div class="ai-panel" id="ai-panel">
            <div class="ai-panel-header">
                <h3 data-i18n="ai_assistant">AI助手</h3>
                <button class="btn btn-icon" id="toggle-ai-panel" title="收起/展开">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <div class="ai-panel-content">
                <div class="ai-settings">
                    <div class="form-group">
                        <label data-i18n="service_type">服务类型:</label>
                        <select id="ai-service-type">
                            <option value="online" data-i18n="online_api">在线API</option>
                            <option value="ollama" data-i18n="local_ollama">本地OLLAMA</option>
                        </select>
                    </div>
                    <div class="form-group" id="online-api-group">
                        <label data-i18n="api_url">API地址:</label>
                        <input type="text" id="api-url" value="https://api.openai.com/v1/chat/completions" placeholder="https://api.openai.com/v1/chat/completions">
                    </div>
                    <div class="form-group" id="api-key-group">
                        <label data-i18n="api_key">API密钥:</label>
                        <input type="password" id="api-key" placeholder="sk-...">
                    </div>
                    <div class="form-group" id="ollama-group" style="display: none;">
                        <label data-i18n="ollama_url">OLLAMA地址:</label>
                        <input type="text" id="ollama-url" value="http://localhost:11434" placeholder="http://localhost:11434">
                        <button class="btn btn-secondary" id="refresh-models-btn" data-i18n="refresh_models">刷新模型</button>
                    </div>
                    <div class="form-group">
                        <label data-i18n="model">模型:</label>
                        <select id="ai-model">
                            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                            <option value="gpt-4">GPT-4</option>
                            <option value="gpt-4-turbo">GPT-4 Turbo</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" id="save-settings-btn" data-i18n="save_settings">保存设置</button>
                </div>
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <!-- 聊天消息将在这里显示 -->
                    </div>
                    <div class="chat-input-container">
                        <input type="text" id="chat-input" placeholder="输入消息..." data-i18n-placeholder="enter_message">
                        <button class="btn btn-primary" id="send-btn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 浮动AI按钮 -->
    <div class="floating-ai-btn" id="floating-ai-btn" title="AI编辑">
        <i class="fas fa-magic"></i>
    </div>

    <!-- AI编辑弹窗 -->
    <div class="modal" id="ai-edit-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 data-i18n="ai_edit">AI编辑</h3>
                <button class="close-btn" id="close-ai-edit-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label data-i18n="selected_text">选中的文字:</label>
                    <div id="selected-text-preview" class="text-preview"></div>
                </div>
                <div class="form-group">
                    <label data-i18n="instruction">编辑指令:</label>
                    <textarea id="ai-edit-instruction" placeholder="告诉AI如何处理这段文字..." data-i18n-placeholder="tell_ai_instruction"></textarea>
                </div>
                <div class="form-group">
                    <label data-i18n="ai_response">AI回复:</label>
                    <div id="ai-edit-response" class="ai-response"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="ai-edit-replace" data-i18n="replace">替换</button>
                <button class="btn btn-secondary" id="ai-edit-append" data-i18n="append">追加</button>
                <button class="btn btn-secondary" id="ai-edit-copy" data-i18n="copy">复制</button>
                <button class="btn btn-primary" id="ai-edit-regenerate" data-i18n="regenerate">重新生成</button>
            </div>
        </div>
    </div>

    <!-- 新建文档弹窗 -->
    <div class="modal" id="new-doc-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 data-i18n="new_document">新建文档</h3>
                <button class="close-btn" id="close-new-doc-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label data-i18n="document_name">文档名称:</label>
                    <input type="text" id="new-doc-name" placeholder="输入文档名称..." data-i18n-placeholder="enter_doc_name">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-new-doc" data-i18n="cancel">取消</button>
                <button class="btn btn-primary" id="confirm-new-doc" data-i18n="create">创建</button>
            </div>
        </div>
    </div>

    <!-- 重命名文档弹窗 -->
    <div class="modal" id="rename-doc-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 data-i18n="rename_document">重命名文档</h3>
                <button class="close-btn" id="close-rename-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label data-i18n="new_name">新名称:</label>
                    <input type="text" id="rename-doc-input" placeholder="输入新名称..." data-i18n-placeholder="enter_new_name">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-rename" data-i18n="cancel">取消</button>
                <button class="btn btn-primary" id="confirm-rename" data-i18n="rename">重命名</button>
            </div>
        </div>
    </div>

    <!-- 设置弹窗 -->
    <div class="modal" id="settings-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 data-i18n="settings">设置</h3>
                <button class="close-btn" id="close-settings-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-tabs">
                    <button class="tab-btn active" data-tab="general" data-i18n="general">通用</button>
                    <button class="tab-btn" data-tab="ai" data-i18n="ai_settings">AI设置</button>
                </div>
                
                <div class="settings-content">
                    <div class="settings-panel active" id="general-panel">
                        <div class="form-group">
                            <label data-i18n="language">语言:</label>
                            <select id="settings-language">
                                <option value="zh-CN" data-i18n="chinese">中文</option>
                                <option value="en" data-i18n="english">English</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="settings-panel" id="ai-panel">
                        <div class="form-group">
                            <label data-i18n="chat_ai_service">聊天AI服务:</label>
                            <select id="settings-chat-service-type">
                                <option value="online" data-i18n="online_api">在线API</option>
                                <option value="ollama" data-i18n="local_ollama">本地OLLAMA</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label data-i18n="floating_ai_service">浮动AI服务:</label>
                            <select id="settings-floating-service-type">
                                <option value="online" data-i18n="online_api">在线API</option>
                                <option value="ollama" data-i18n="local_ollama">本地OLLAMA</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-settings" data-i18n="cancel">取消</button>
                <button class="btn btn-primary" id="save-settings" data-i18n="save">保存</button>
            </div>
        </div>
    </div>

    <!-- 删除确认弹窗 -->
    <div class="modal" id="delete-confirm-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 data-i18n="confirm_delete">确认删除</h3>
                <button class="close-btn" id="close-delete-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p data-i18n="delete_warning">确定要删除这个文档吗？此操作不可撤销。</p>
                <p id="delete-doc-name"></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-delete" data-i18n="cancel">取消</button>
                <button class="btn btn-danger" id="confirm-delete" data-i18n="delete">删除</button>
            </div>
        </div>
    </div>

    <!-- 遮罩层 -->
    <div class="overlay" id="overlay"></div>

    <!-- JavaScript文件 -->
    <script src="{{ url_for('static', filename='js/i18n.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>